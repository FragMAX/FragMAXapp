{% extends 'fragview/base.html' %} {% load static %} {% block title %}FragMAX - Data Analysis{% endblock %} {% block content %}

<style xmlns="http://www.w3.org/1999/html">
    html {
    overflow: scroll;
    overflow-x: hidden;
    }
    ::-webkit-scrollbar {
        width: 0px;  /* Remove scrollbar space */
        background: transparent;  /* Optional: just make scrollbar invisible */
    }
    /* Optional: show position indicator in red */
    ::-webkit-scrollbar-thumb {
        background: #FF0000;
    }
    .floatedTable {
        float: left;
    }
    
    .inlineTable {
        display: inline-block;
    }
    
    td,
    th {
        padding: 5px 5px;
        display: table-cell;
        text-align: left;
        vertical-align: middle;
        border-radius: 2px;
        font-size: 12px;
    }
    
    .top-options {
        font-size: 15px !important;
    }
    
    .content {
        margin: auto !important;
        max-width: 100% !important;
        width: 100% !important;
    }
    
    .card-content-left {
        padding: 24px 24px 38px 24px !important;
    }
    
    .card-content-right {
        padding: 24px 24px 28px 24px !important;
    }
    
    .card_options {
        padding-left: 310px !important;
        max-width: calc(100% - 50px) !important;
    }
    
    .flexdiv {
        display: flex;
        padding-left: 300px;
        max-width: calc(100% - 50px) !important;
    }
    
    .flexdiv_options {
        display: flex;
    }
    
    .flex-left {
        max-width: 750px;
        width: 30%
    }
    
    .flex-right {
        margin-left: 3%;
        max-width: 750px;
        width: 30%
    }
    
    .flex-center {
        margin-left: 3%;
        max-width: 750px;
        width: 30%
    }
    
    .selectbox {
        display: flex !important;
    }
    
    .optionstable {
        border-collapse: separate;
        border-spacing: 0;
    }
    
    .btn-right {
        position: absolute;
        bottom: 13px;
    }
    
    .maxivorange {
        background-color: #fea901;
    }
    
    .custompar {
        background-color: #f0f0f0;
    }
    
    .card-title {
        display: inline-flex !important;
    }
    
    .datasetbox {
        max-width: 350px;
        margin-left: 16px;
    }
    /* Style the tab */
    
    .tab {
        overflow: hidden;
        background-color: #f1f1f1;
    }
    /* Style the buttons inside the tab */
    
    .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
    }
    /* Create an active/current tablink class */
    
    .tab button.active {
        background-color: #fea901;
    }
    /* Style the tab content */
    
    .tabcontent {
        display: none;
        padding: 6px 12px;
    }
    
    .slider {
        -webkit-appearance: none;
        height: 25px;
        padding-left: 10px !important;
    }
    
    #tablecontainer {
        column-count: 2;
        -moz-column-count: 2;
        -webkit-column-count: 2;
    }
    
    span {
        display: inline !important;
    }
</style>

<div>
    <div style="position:absolute; right: 50px">
        <h5>HPC Nodes</h5>
        <div class="radio" id="nodes" >
            <label>
                <input class="with-gap" id="1node" name="node_number" type="radio" value="1">
                <span class="item-label" for="1node">1</span>
            </label>
            <label>
                <input checked class="with-gap" id="3node" name="node_number" type="radio" value="3">
                <span class="item-label" for="3node">3</span>
            </label>
            <label>
                <input class="with-gap" id="6node" name="node_number" type="radio" value="6">
                <span class="item-label" for="6node">6</span>
            </label>
            <label>
                <input class="with-gap" id="9node" name="node_number" type="radio" value="9">
                <span class="item-label" for="9node">9</span>
            </label>
        </div>
    </div>
    <h5 style="padding-left:310px;">{{project.protein}} Data Analysis</h5>

    <h6 style="padding-left:330px;">• New actions will process/reprocess your datasets using at MAX IV HPC and
        <b>replace</b> your current result</h6>
    {% comment %}
    <h7 style="padding-left:330px;">&bull; BioMAX autoprocessing statistics is displayed in the bottom of the page</h7> {% endcomment %}
    <div style="padding-left:310px;display: flex">
        <label style="padding-top: 10px;">
            <input checked class="filled-in dt-checkboxes" id="processALLckbox" name="processALLckbox"
                type="checkbox" value="alldatasets">
            <span for="processALLckbox">Process all datasets </span> </label>
        <label style="padding-top: 10px; padding-left: 20px">
            <input class="filled-in dt-checkboxes" id="processALLNEWckbox" name="processALLNEWckbox" type="checkbox"
                value="allnewdatasets" >
            <span for="processALLNEWckbox">Process new datasets </span></input>
        </label>
        <label style="padding-top: 10px; padding-left: 20px">
            <input class="filled-in dt-checkboxes" id="checkALLdatasets" name="checkALLdatasets"
                type="checkbox" value="chckalldatasets">
            <span for="checkALLdatasets">Select ALL datasets </span> </label>
    </div>
    <div class=" card_options">
        <div class="card tab">
            <button class="tablinks" onclick="openDatasets(event, 'Datasets')">Select dataset</button>
            <button class="tablinks" onclick="openDatasets(event, 'HideDatasets')">Hide</button>
        </div>

        <div class="card tabcontent" id="Datasets">


            <div id="tablecontainer">

                <table>
                    <tbody>

                        {% for datasetName in datasets %}
                        <tr>
                            <td style="width:20px">
                                <label>
                        <input class="filled-in dt-checkboxes" id="checkSelection{{datasetName}}" name="checkSel" type="checkbox"><span></span>
                    </label>
                            </td>
                            <td>
                                {{datasetName}}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>


<!-- The Modal -->
<div class="modal" id="myModal">
    <span class="close">&times;</span>
    <img class="modal-content" id="img01">
    <div id="caption"></div>
</div>

<div class="card_options">
    <div class="flexdiv_options card ">
        <div class="flex-left">
            <div>
                <div class="card-content card-content-left">
                    <div class="card-title">Data processing</div>
                    <form action="/dataproc_datasets/" id="dtprocBtn" method="post"
                          name="dataprocButton" size="1" target="_blank">

                        {% csrf_token %}
                        <input type="hidden" name="datasetsFilter" id="dtsFilterProc"/>
                        <input type="hidden" name="hpcNodes" id="hpcNodesProc"/>
                        <input type="hidden" name="friedelLaw" id="friedelLawProc"/>
                        <input type="hidden" name="customXds" id="customXds"/>
                        <input type="hidden" name="customAutoProc" id="customAutoProc"/>
                        <input type="hidden" name="customDials" id="customDials"/>
                        <input type="hidden" name="customXdsApp" id="customXdsApp"/>

                    <table class="optionstable">
                        <col width="8%">
                        <col width="17%">
                        <tbody>
                            <tr>
                                <th class="top-options">Software</th>
                                <td class=" top-options">
                                    <br>
                                    <div>
                                        <div class="checkbox" id="pipedream">
                                            <label>
                                                    <input class="ligandform filled-in dt-checkboxes pipedreamcheck"
                                                        id="pipedreamcheckboxinputproc" name="pipedreamcheckboxname"
                                                        type="checkbox" value="pipedream">
                                                    <span for="pipedreamcheckboxinputproc">Pipedream </span>
                                                </label>
                                        </div>
                                        <div class="checkbox" id="dials">
                                            <label>
                                                <input class="processform filled-in dt-checkboxes" id="dialscheckboxinput"
                                                       name="useDials" type="checkbox">
                                                <span for="dialscheckboxinput">XIA2/DIALS</span>
                                            </label>
                                        </div>
                                        <div class="checkbox" id="xdsxscale">
                                            <label>
                                                <input class="processform filled-in dt-checkboxes" id="xdsxscalecheckboxinput"
                                                       name="useXdsxscale" type="checkbox">
                                                <span for="xdsxscalecheckboxinput">XIA2/XDS_XSCALE</span>
                                            </label>
                                        </div>
                                        <div class="checkbox" id="xdsapp">
                                            <label>
                                                <input class="processform filled-in dt-checkboxes" id="xdsappcheckboxinput"
                                                       name="useXdsapp" type="checkbox" value="xdsapp">
                                                <span for="xdsappcheckboxinput">XDSAPP</span>
                                            </label>
                                        </div>
                                        <div class="checkbox" id="autoproc">
                                            <label>
                                                <input class="processform filled-in dt-checkboxes" id="autoproccheckboxinput"
                                                       name="useAutoproc" type="checkbox">
                                                <span for="autoproccheckboxinput">autoProc </span>
                                            </label>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th class=" top-options">Space group</th>
                                <td class=" top-options">
                                    <input class="selectbox" name="spaceGroup" placeholder="P43212"/>
                                </td>
                            </tr>

                            <tr>
                                <th class=" top-options">Cell parameters</th>
                                <td class=" top-options">
                                    <input class="selectbox" name="cellParams" placeholder="(a, b, c, α, β, γ)"/>
                                </td>
                            </tr>
                            <tr>
                                <th></th>
                                <td style="padding-top:50px">
                                    <button class="btn-large  btn-right" disabled id="submitdtProc" name="submitdtProc"
                                            onsubmit="return dataproc()" size="1" type="submit">
                                        Run data processing
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    </form>
                </div>
            </div>
        </div>

        <div class="flex-center">
            <div>

                <div class="card-content card-content-left">
                    <div class="card-title">Structure Refinement</div>
                    <form action="/refine_datasets/" id="rfprocBtn"
                          method="post" name="rfprocButton" size="1" target="_blank">

                        {% csrf_token %}
                        <input type="hidden" name="datasetsFilter" id="dtsFilterRefine"/>
                        <input type="hidden" name="hpcNodes" id="hpcNodesRefine"/>
                        <input type="hidden" name="customRefDimple"/>
                        <input type="hidden" name="customRefBuster"/>
                        <input type="hidden" name="customRefFspipe"/>

                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">Software</th>
                                    <td class=" top-options">
                                        <br>
                                        <div>
                                            <div class="checkbox " id="pipedream">
                                                <label>
                                                    <input class="ligandform filled-in dt-checkboxes pipedreamcheck"
                                                        id="pipedreamcheckboxinputref" name="pipedreamcheckboxname"
                                                        type="checkbox" value="pipedream">
                                                    <span for="pipedreamcheckboxinputref">Pipedream</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="dials">
                                                <label>
                                                        <input class="refineform filled-in dt-checkboxes" id="dimplecheckboxinput"
                                                            name="useDimple" type="checkbox">
                                                        <span for="dimplecheckboxinput">DIMPLE</span>
                                                    </label>
                                            </div>
                                            <div class="checkbox" id="xdsxscale">
                                                <label>
                                                        <input class="refineform filled-in dt-checkboxes" id="bustercheckboxinput"
                                                            name="useBuster" type="checkbox">
                                                        <span for="bustercheckboxinput">BUSTER</span>
                                                    </label>
                                            </div>
                                            <div class="checkbox" id="autoproc">
                                                <label>
                                                        <input class="refineform filled-in dt-checkboxes" id="fspcheckboxinput"
                                                            name="useFSpipeline" type="checkbox">
                                                        <span for="fspcheckboxinput">fspipeline</span>
                                                    </label>
                                            </div>
                                        </div>

                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">PDB model</th>
                                    <td class=" top-options">
                                        <select class="refineform selectbox" name="pdbModel">
                                            {% for pdb in pdbs %}
                                                <option value="{{pdb.id}}">{{pdb.filename}}</option>
                                            {% endfor %}
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Space group</th>
                                    <td class=" top-options">
                                        <label>
                                        <input class="refineform selectbox" name="refSpaceGroup" placeholder="P43212"/>
                                        </label>
                                        <div class="checkbox" id="aimless">
                                            <label>
                                                <input class="filled-in dt-checkboxes" id="aimlesscheckboxinput"
                                                    name="runAimless" type="checkbox" value="aimless">
                                                <span for="aimlesscheckboxinput">Run aimless </span>
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td style="padding-top:20px">
                                        <button class="btn-large btn-right" disabled id="submitrfProc"
                                                name="submitrfProc" onsubmit="return refineproc()" size="1"
                                                type="submit">
                                            Run refinement
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </div>
            </div>
        </div>


        <div class="flex-right">
            <div>
                <div class="card-content card-content-right">
                    <div class="card-title">Ligand fitting</div>
                    <form action="/ligfit_datasets/" id="ligprocBtn" method="post"
                          name="ligprocButton" size="1" target="_blank">

                        {% csrf_token %}
                        <input type="hidden" name="datasetsFilter" id="dtsFilterLigfit"/>
                        <input type="hidden" name="hpcNodes" id="hpcNodesLigfit"/>
                        <input type="hidden" name="cifMethod" id="cifMethodLigfit"/>

                    <table class="optionstable">
                        <col width="8%">
                        <col width="17%">
                        <tbody>
                            <tr>
                                <th class=" top-options">Software</th>
                                <td class=" top-options">
                                    <form id="swSelectionForrefinement">
                                        <br>
                                        <div>
                                            <div class="checkbox " id="pipedream">
                                                <label>
                                                    <input class="ligandform filled-in dt-checkboxes pipedreamcheck"
                                                        id="pipedreamcheckboxinputlig" name="pipedreamcheckboxname"
                                                        type="checkbox" value="pipedream">
                                                    <span for="pipedreamcheckboxinputlig">Pipedream</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="rhofit">
                                                <label>
                                                    <input class="ligandform filled-in dt-checkboxes"
                                                           id="rhofitcheckboxinput" name="useRhoFit" type="checkbox">
                                                    <span for="rhofitcheckboxinput">RhoFit</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="ligfit">
                                                <label>
                                                    <input class="ligandform filled-in dt-checkboxes"
                                                        id="phenixligfitcheckboxinput" name="usePhenixLigfit"
                                                        type="checkbox">
                                                    <span for="phenixligfitcheckboxinput">LigandFit</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="pandda">
                                                <label>
                                                    <input class="ligandform filled-in dt-checkboxes"
                                                        id="panddacheckboxinput" name="panddacheckboxname"
                                                        type="checkbox" value="panddaanalysis">
                                                    <span for="panddacheckboxinput">PanDDA</span>
                                                </label>
                                            </div>
                                        </div>




                                        <div class="radio" id="cif_gen_method" style="padding-top: 20px; max-width: 250px; display: inline-flex; margin-left: -175px;">
                                            <label>
                                                <input class="with-gap" id="grade" name="library_method" type="radio" value="grade">
                                                <span class="item-label" for="grade">GRADE</span>
                                            </label>
                                            <label>
                                                <input class="with-gap" id="acedrug" name="library_method" type="radio" value="acedrg" >
                                                <span class="item-label" for="acedrug">AceDRG</span>
                                            </label>
                                            <label>
                                                <input checked class="with-gap" id="elbow" name="library_method" type="radio" value="elbow">
                                                <span class="item-label" for="elbow">eLBOW</span>
                                            </label>

                                        </div>
                                    </form>
                            </tr>
                            <tr>
                                <th></th>
                                <td style="padding-top:200px">
                                    <button class="btn-large  btn-right" disabled id="submitligProc"
                                            name="submitligProc" onsubmit="return ligandfitproc()" size="1" type="submit">
                                        Run ligand fitting
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>

<p hidden id="pdbcontent"></p>
<h6 style="padding-left:330px;">Click the tabs to change parameters for each software</h6>


<div class=" card_options">
    <div class="card tab">
        <button class="tablinks" onclick="openMethod(event, 'DIALS')">XIA2/DIALS</button>
        <button class="tablinks" onclick="openMethod(event, 'XDS_XSCALE')">XIA2/XDS_XSCALE</button>
        <button class="tablinks" onclick="openMethod(event, 'XDSAPP')">XDSAPP</button>
        <button class="tablinks" onclick="openMethod(event, 'autoPROC')">autoPROC</button>
        <button class="tablinks" onclick="openMethod(event, 'DIMPLE')">DIMPLE</button>
        <button class="tablinks" onclick="openMethod(event, 'BUSTER')">BUSTER</button>
        <button class="tablinks" onclick="openMethod(event, 'fspipeline')">fspipeline</button>
        <button class="tablinks" onclick="openMethod(event, 'RhoFit')">RhoFit</button>
        <button class="tablinks" onclick="openMethod(event, 'LigFit')">LigandFit</button>
        <button class="tablinks" onclick="openMethod(event, 'PanDDA')">PanDDA</button>
        <button class="tablinks" onclick="openMethod(event, 'Pipedream')">Pipedream</button>
        <button class="tablinks" onclick="openMethod(event, 'Hide')">Hide</button>


    </div>

    <div class="card tabcontent" id="DIALS">
        <div class="card-title">XIA2/Dials Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Friedel law</th>
                    <td class=" top-options">
                        <select class="selectbox" name="friedel">
                            <option selected value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </td>
                </tr>
                <tr hidden>
                    <th class=" top-options">Data range</th>
                    <td class=" top-options"><input class="selectbox" name="datarange" placeholder="1-1800"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Resolution cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="rescutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">CC1/2 cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="cccutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">I/σ(I) cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="isigmacutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customdataproc-dials" placeholder="default: None"></input>
                        See available parameters <a href="https://xia2.github.io/parameters.html" target="_blank">here</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="XDS_XSCALE">
        <div class="card-title">XIA2/XDS-XSCALE Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Friedel law</th>
                    <td class=" top-options">
                        <select class="selectbox" name="friedel">
                            <option selected value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </td>
                </tr>
                <tr hidden>
                    <th class=" top-options">Data range</th>
                    <td class=" top-options"><input class="selectbox" name="datarange" placeholder="1-1800"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Resolution cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="rescutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">CC1/2 cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="cccutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">I/σ(I) cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="isigmacutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customdataproc-xds" placeholder="default: None"></input>
                        See available parameters <a href="https://xia2.github.io/parameters.html" target="_blank">here</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="autoPROC">
        <div class="card-title">autoPROC Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Friedel law</th>
                    <td class=" top-options">
                        <select class="selectbox" name="friedel">
                            <option selected value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </td>
                </tr>
                <tr hidden>
                    <th class=" top-options">Data range</th>
                    <td class=" top-options"><input class="selectbox" name="datarange" placeholder="1-1800"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Resolution cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="rescutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">CC1/2 cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="cccutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">I/σ(I) cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="isigmacutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customdataproc-autoproc" placeholder="default: None"></input>
                        See available parameters <a href="https://www.globalphasing.com/autoproc/manual/autoPROC4.html#processcli" target="_blank">here</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="XDSAPP">
        <div class="card-title">XDSAPP Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Friedel law</th>
                    <td class=" top-options">
                        <select class="selectbox" name="friedel">
                            <option selected value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </td>
                </tr>
                <tr hidden>
                    <th class=" top-options">Data range</th>
                    <td class=" top-options"><input class="selectbox" name="datarange" placeholder="1-1800"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Resolution cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="rescutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">CC1/2 cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="cccutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">I/σ(I) cutoff</th>
                    <td class=" top-options"><input class="selectbox" name="isigmacutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customdataproc-xdsapp" placeholder="default: None"></input>
                        See available parameters <a href="https://www.helmholtz-berlin.de/forschung/oe/np/gmx/xdsapp/usage/multiple-datasets_en.html" target="_blank">here</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="DIMPLE">
        <div class="card-title">DIMPLE Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Refinement method</th>
                    <td class=" top-options">
                        <div class="radio" id="dimpleSlow">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Normal</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">Slow</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slowest" name="slowest" type="radio" value="2">
                                <span class="item-label" for="slowest">Slowest</span>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Water placement</th>
                    <td class=" top-options">
                        <form id="swSelectionForrefinement">
                            <br>
                            <div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="arpwarpcheckboxinput"
                                            name="arpwarpcheckboxname" type="checkbox" value="arpwarp">
                                        <span for="arpwarpcheckboxinput">use ARP/wARP </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="cootwatercheckboxinput"
                                            name="cootwatercheckboxname" type="checkbox" value="cootwater">
                                        <span for="cootwatercheckboxinput">use Coot </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled
                                            id="phenixwatercheckboxinput" name="phenixwatercheckboxname" type="checkbox"
                                            value="phenixwater">
                                        <span for="phenixwatercheckboxinput">use Phenix </span>
                                    </label>
                                </div>
                            </div>
                        </form>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Refmac keywords</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="refmac-key" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Remove HETATM</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="refrescutoff" placeholder="default: False"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Rigid body cycles</th>
                    <td class=" top-options">
                        {% comment %} <input class="selectbox" disabled name="refrescutoff" placeholder="default: 10"></input> {% endcomment %}
                        <div style="display: flex;">
                            <p style="width: 30px;"><span id="rigidvalue"></span></p>
                            <input class="slider" id="rigidRange" max="20" min="1" type="range" value="10">
                        </div>

                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Jelly body cycles</th>
                    <td class=" top-options">
                        {% comment %} <input class="selectbox" disabled name="refrescutoff" placeholder="default: 4"></input> {% endcomment %}
                        <div style="display: flex;">
                            <p style="width: 30px;"><span id="jellyvalue"></span></p>
                            <input class="slider" id="jellyRange" max="15" min="1" type="range" value="4">
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Threshold for MR</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="mrthresh" placeholder="default: 0.4"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Resolution cutoff</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="refrescutoff" placeholder="default: None"></input>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Nr of Molecules for MR</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="refrescutoff" placeholder="default: 1"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customrefine-dimple" placeholder="default: None"></input>
                    See available parameters <a href="http://ccp4.github.io/dimple/" target="_blank">here</a>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="BUSTER">
        <div class="card-title">BUSTER Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Water placement</th>
                    <td class=" top-options">
                        <form id="swSelectionForrefinement">
                            <br>
                            <div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="arpwarpcheckboxinput"
                                            name="arpwarpcheckboxname" type="checkbox" value="arpwarp">
                                        <span for="arpwarpcheckboxinput">use ARP/wARP </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="cootwatercheckboxinput"
                                            name="cootwatercheckboxname" type="checkbox" value="cootwater">
                                        <span for="cootwatercheckboxinput">use Coot </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled
                                            id="phenixwatercheckboxinput" name="phenixwatercheckboxname" type="checkbox"
                                            value="phenixwater">
                                        <span for="phenixwatercheckboxinput">use Phenix </span>
                                    </label>
                                </div>
                            </div>
                        </form>
                    </td>
                </tr>
                <tr>

                    <tr>
                        <th class=" top-options">Refinement mode</th>
                        <td class=" top-options">
                            <select class="selectbox" disabled name="refMode">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="refslow">Extra (Slowest)</option>
                            <option value="refslow">Normal (Slow)</option>
                            <option value="reffast">Quick (Fast)</option>
                        </select>
                        </td>
                    </tr>
                    <tr>
                        <th class=" top-options">Threshold for MR</th>
                        <td class=" top-options">
                            <input class="selectbox" disabled name="mrthresh" placeholder="default: 0.4"></input>
                        </td>
                    </tr>
                    <tr>
                        <th class=" top-options">Resolution cutoff</th>
                        <td class=" top-options">
                            <input class="selectbox" disabled name="refrescutoff" placeholder="default: None"></input>
                        </td>
                    </tr>



                    <tr class="custompar">
                        <th class=" top-options">Custom parameters</th>
                        <td class=" top-options"><input class="selectbox" name="customrefine-buster" placeholder="default: None"></input>
                        See available parameters <a href="https://www.globalphasing.com/buster/manual/autobuster/manual/autoBUSTER4.html#refine_args" target="_blank">here</a>
                        </td>
                    </tr>

            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="fspipeline">
        <div class="card-title">fspipeline Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Water placement</th>
                    <td class=" top-options">
                        <form id="swSelectionForrefinement">
                            <br>
                            <div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="arpwarpcheckboxinput"
                                            name="arpwarpcheckboxname" type="checkbox" value="arpwarp">
                                        <span for="arpwarpcheckboxinput">use ARP/wARP </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled id="cootwatercheckboxinput"
                                            name="cootwatercheckboxname" type="checkbox" value="cootwater">
                                        <span for="cootwatercheckboxinput">use Coot </span>
                                    </label>
                                </div>
                                <div class="checkbox" id="arpwarp">
                                    <label>
                                        <input class="filled-in dt-checkboxes" disabled
                                            id="phenixwatercheckboxinput" name="phenixwatercheckboxname" type="checkbox"
                                            value="phenixwater">
                                        <span for="phenixwatercheckboxinput">use Phenix </span>
                                    </label>
                                </div>
                            </div>
                        </form>
                    </td>
                </tr>

                <tr>
                    <th class=" top-options">Use original MTZ</th>
                    <td class=" top-options">
                        <div class="checkbox" id="originalMTZ">
                            <label>
                                <input class="filled-in dt-checkboxes" disabled
                                    id="orimtzcheckboxinput" name="orimtzcheckboxname" type="checkbox" value="orimtz">
                                <span for="orimtzcheckboxinput"></span>
                            </label>
                        </div>
                    </td>
                </tr>

                <tr>
                    <th class=" top-options">Molecular Replacement</th>
                    <td class=" top-options">
                        <div class="radio" id="fspMR">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Yes</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">No</span>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Remove Hydrogens </th>
                    <td class=" top-options">
                        <div class="radio" id="fspRMh">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Yes</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">No</span>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Remove Ligands </th>
                    <td class=" top-options">
                        <div class="radio" id="fspRMl">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Yes</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">No</span>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Remove Water </th>
                    <td class=" top-options">
                        <div class="radio" id="fspRMw">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Yes</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">No</span>
                            </label>
                        </div>
                    </td>
                </tr>

                <tr>
                    <th class=" top-options">Simulated Annealing</th>
                    <td class=" top-options">
                        <div class="radio" id="fspSA">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="0">
                                <span class="item-label" for="normal">Yes</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="1">
                                <span class="item-label" for="slow">No</span>
                            </label>
                        </div>
                    </td>
                </tr>

                <tr>
                    <th class=" top-options">Coot blob level</th>
                    <td class=" top-options">
                        <div style="display: flex;">
                            <p style="width: 30px;"><span id="fspcBlobvalue"></span></p>
                            <input class="slider" id="fspcb" max="50" min="0" type="range" value="15">
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Coot blob map</th>
                    <td class=" top-options">
                        <div class="radio" id="fspCootMAP">
                            <label>
                                <input checked class="with-gap" disabled id="normal" name="normal" type="radio"
                                    value="1">
                                <span class="item-label" for="normal">2Fo-Fc</span>
                            </label>
                            <label>
                                <input class="with-gap" disabled id="slow" name="slow" type="radio" value="2">
                                <span class="item-label" for="slow">3Fo-2Fc</span>
                            </label>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class=" top-options">Coot Peak diff search</th>
                    <td class=" top-options">
                        <div style="display: flex;">
                            <p style="width: 30px;"><span id="fspcDiffvalue"></span></p>
                            <input class="slider" id="fspcd" max="10" min="0" type="range" value="5">
                        </div>
                    </td>
                </tr>

                <tr>
                    <th class=" top-options">Threshold for MR</th>
                    <td class=" top-options">
                        <input class="selectbox" disabled name="mrthresh" placeholder="default: 0.4"></input>
                    </td>
                </tr>
                <tr class="custompar">
                    <th class=" top-options">Custom parameters</th>
                    <td class=" top-options"><input class="selectbox" name="customrefine-fsp" placeholder="default: None"></input>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="RhoFit">
        <div class="card-title">RhoFit Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Fitting process</th>
                    <td class=" top-options">
                        <select class="selectbox" name="fitprocess">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="ligfitquick">Quick</option>
                            <option value="ligfitthorough">Thorough</option>
                        </select>
                    </td>
                    <tr>
                    </tr>
                    <tr>
                        <th class=" top-options">Scan chirals</th>
                        <td class=" top-options">
                            <select class="selectbox" name="scanchirals">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="chiralsyes">Yes</option>
                            <option value="chiralsno">No</option>
                        </select>
                        </td>
                    </tr>
                    <tr class="custompar">
                        <th class=" top-options">Custom parameters</th>
                        <td class=" top-options"><input class="selectbox" name="customligfit-rhofit" placeholder="default: None"></input>
                        See available parameters <a href="https://www.globalphasing.com/buster/manual/rhofit/manual/#keywords" target="_blank">here</a>
                        </td>
                    </tr>

            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="LigFit">
        <div class="card-title">LigandFit Options</div>
        <table class="optionstable flex-left">
            <col width="8%">
            <col width="17%">
            <tbody>
                <tr>
                    <th class=" top-options">Fitting process</th>
                    <td class=" top-options">
                        <select class="selectbox" name="fitprocess">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="ligfitquick">Quick</option>
                            <option value="ligfitthorough">Thorough</option>
                        </select>
                    </td>
                    <tr>
                    </tr>
                    <tr>
                        <th class=" top-options">Scan chirals</th>
                        <td class=" top-options">
                            <select class="selectbox" name="scanchirals">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="chiralsyes">Yes</option>
                            <option value="chiralsno">No</option>
                        </select>
                        </td>
                    </tr>
                    <tr class="custompar">
                        <th class=" top-options">Custom parameters</th>
                        <td class=" top-options"><input class="selectbox" name="customligfit-ligfit" placeholder="default: None"></input>
                        See available parameters <a href="https://www.phenix-online.org/documentation/reference/ligandfit.html#sample-command-line-inputs" target="_blank">here</a>
                        </td>
                    </tr>

            </tbody>
        </table>
    </div>
    <div class="card tabcontent" id="PanDDA">
        <div class="card-title">PanDDA Options</div>
        <div class="flexdiv_options  ">
            <div class="flex-left">
                <div>
                    <div class="card-content card-content-left">
                        <div class="card-title">Dataset selection</div>
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">Processing</th>
                                    <td class=" top-options">
                                        <div class="col s12 required inline" id="processing_method">
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="xdsapp_radio" name="proc_type" type="radio" value="xdsapp">
                                                    <span class="item-label" for="xdsapp_radio">XDSAPP</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="autoproc_radio" name="proc_type" type="radio" value="autoproc">
                                                    <span class="item-label" for="autoproc_radio">autoPROC</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="dials_radio" name="proc_type" type="radio" value="dials">
                                                    <span class="item-label" for="dials_radio">XIA2/DIALS</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="xdsxscale_radio" name="proc_type" type="radio" value="xdsxscale">
                                                    <span class="item-label" for="xdsxscale_radio">XIA2/XDS</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="edna_proc_radio" name="proc_type" type="radio" value="EDNA">
                                                    <span class="item-label" for="edna_proc_radio">EDNA_proc</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input class="with-gap" id="fastdp_radio" name="proc_type" type="radio" value="fastdp">
                                                    <span class="item-label" for="fastdp_radio">fastdp</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataproc_type">
                                                <label>
                                                <input checked="checked" class="with-gap" id="bestdp_radio" name="proc_type" type="radio" value="bestdp">
                                                    <span class="item-label" for="bestdp_radio">Best</span>
                                                </label>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Refinement</th>
                                    <td class=" top-options">
                                        <div class="col s12 required inline" id="refinement_method">
                                            <div class="radio" id="dataref_type">
                                                <label>
                                                    <input class="with-gap" id="dimple_radio" name="ref_type" type="radio" value="dimple">
                                                    <span class="item-label" for="dimple_radio">DIMPLE</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataref_type">
                                                <label>
                                                    <input class="with-gap" id="fspipeline_radio" name="ref_type" type="radio" value="fspipeline">
                                                    <span class="item-label" for="fspipeline_radio">fspipeline</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataref_type">
                                                <label>
                                                    <input class="with-gap" id="buster_radio" name="ref_type" type="radio" value="buster">
                                                    <span class="item-label" for="buster_radio">BUSTER</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="dataref_type">
                                                <label>
                                                    <input checked="checked" class="with-gap" id="bestproc_radio" name="ref_type" type="radio" value="bestproc">
                                                    <span class="item-label" for="bestproc_radio">Best</span>
                                                </label>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Complete results
                                        <sup>1</sup>
                                    </th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="compdatasets">
                                            <option disabled value="true"> -- select an option -- </option>
                                            <option selected value="true">Yes</option>
                                            <option value="false">No</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Ground state build</th>
                                    <td class=" top-options">
                                        <form id="groundstate">
                                            <div class="checkbox" id="groundStateModel">
                                                <label>
                                                <input checked class="filled-in dt-checkboxes" id="apoGS" name="apoGS" type="checkbox" value="apoGS">
                                                    <span for="apoGS">Use known Apo</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="dmsoGScheck">
                                                <label>
                                                <input checked class="filled-in dt-checkboxes" id="dmsoGS" name="dmsoGS" type="checkbox" value="dmsoGS">
                                                    <span for="dmsoGS">Use Cryo/DMSO datasets</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="proczMapscheck">
                                                <label>
                                                <input checked class="filled-in dt-checkboxes" id="proczMaps" name="proczMaps" type="checkbox" value="proczMaps">
                                                    <span for="proczMaps">Reprocess using datasets without peaks in Z-map</span>
                                                </label>
                                            </div>
                                        </form>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="flex-center">
                <div>
                    <div class="card-content card-content-left">
                        <div class="card-title">PanDDA analysis options</div>
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">Fill missing reflections with CAD</th>
                                    <td class=" top-options">
                                        <select class="selectbox" id="use_CAD" name="use_CAD" disabled>
                                            <option disabled value="yes"> -- select an option -- </option>
                                            <option selected value="yes">Yes</option>
                                            <option value="no">No</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Refine populated MTZ</th>
                                    <td class=" top-options">
                                        <select class="selectbox" id="refine_popMTZ" name="refine_popMTZ" disabled>
                                            <option disabled value="no"> -- select an option -- </option>
                                            <option selected value="phenixRefine">Phenix.Refine</option>
                                            <option value="refmac">Refmac</option>
                                            <option value="no">No</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Options</th>
                                    <td class=" top-options">
                                        <form id="preprocessOptions">
                                            <div class="checkbox" id="ignoreErrcheck">
                                                <label>
                                                    <input checked class="filled-in dt-checkboxes" id="ignoreErr" name="ignoreErr" type="checkbox" value="ignoreErr">
                                                    <span for="ignoreErr">Auto remove dataset with problems</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="keepupcheck">
                                                <label>
                                                    <input class="filled-in dt-checkboxes" id="keepup" name="keepup" type="checkbox" value="keepup">
                                                    <span for="keepup">Continue last analysis</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="fixsymcheck">
                                                <label>
                                                    <input class="filled-in dt-checkboxes" id="fixsym" name="fixsym" type="checkbox" value="fixsym">
                                                    <span for="fixsym">Ignore symlink issues</span>
                                                </label>
                                        </div>
                                        </form>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Minimum dataset for building ground state</th>
                                    <td class=" top-options">
                                        <input class="selectbox" id="min_datasets" placeholder="default: 40"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Maximum R<sub>free</sub></th>
                                    <td class=" top-options">
                                        <input class="selectbox" id="pandda_max_rfree" value="0.40" placeholder="default: 0.40"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Resolution limits</th>
                                    <td class=" top-options" style="display: flex">
                                        <div><input class="selectbox" id="pandda_res_low_limit" value="0.0" placeholder="min: 0.0"></input></div>
                                        <div style="padding-left: 10%;"><input class="selectbox" id="pandda_res_high_limit" value="4.0" placeholder="max: 4.0" ></input></div>
                                    </td>
                                </tr>
                                <tr class="custompar">
                                    <th class=" top-options">Custom parameters</th>
                                    <td class=" top-options">
                                        <input class="selectbox" id="PanDDAcustom" placeholder="default: None"></input>
                                        See available parameters <a href="https://pandda.bitbucket.io/manual.html" target="_blank">here</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="bottom-right">
                    <form action="/submit_pandda/" id="sendpandda" method="get" name="sendpandda" size="1" target="_blank">
                        <button class="btn-large maxivorange" name="panddaform" onsubmit="return panddasetup()" size="1" type="submit" value="pipedreamInput">Run PanDDA</button>
                    </form>
                </div>
            </div>
        </div>
        <hr>
        <div class="card-title">Giant PanDDA</div>
        <div class="flexdiv_options  ">
            <div class="flex-left">
                <div>
                    <div class="card-content card-content-left">
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">Available inspects1</th>
                                    <td class=" top-options">
                                        <select class="selectbox" id="inspects" name="inspects">
                                            <option disabled selected value="yes"> -- select an option -- </option>
                                            {% for method in methods %}
                                            <option value="{{method}}">{{method}}</option>
                                            {% endfor %}

                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Make restraints
                                        </sup>
                                    </th>
                                    <td class=" top-options">
                                        <form id="groundstate">
                                            <div class="checkbox" id="makerestraints">
                                                <label>
                                                    <input checked class="filled-in dt-checkboxes" id="allRestraint" name="allRestraint" type="checkbox" value="allRestraint">
                                                    <span for="allRestraint">Create all restraints</span>
                                                </label>
                                            </div>
                                            <div class="checkbox" id="resnames">
                                                <label>
                                                    <input class="selectbox" name="resnames" placeholder="default: XXX"></input>
                                                </label>
                                            </div>
                                        </form>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Quick refine
                                        </sup>
                                    </th>
                                    <td class=" top-options">
                                        <div style="display:flex">
                                            <select class="selectbox" disabled name="compdatasets">
                                                <option disabled selected value="true"> -- PDB1 -- </option>
                                                <option value="true">pdbmodel</option>
                                                <option value="false">None</option>
                                            </select>
                                            <select class="selectbox" disabled name="compdatasets">
                                                <option disabled selected value="true"> -- MTZ1 -- </option>
                                                <option value="true">mtzfile</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                        <div style="display:flex">
                                            <select class="selectbox" disabled name="compdatasets">
                                                <option disabled selected value="true"> -- PDB2 -- </option>
                                                <option value="true">pdbmodel</option>
                                                <option value="false">No</option>
                                            </select>
                                            <select class="selectbox" disabled name="compdatasets">
                                                <option disabled selected value="true"> -- MTZ2 -- </option>
                                                <option value="true">mtzfile</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="flex-center">
                <div>
                    <div class="card-content card-content-left">
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">Split conformations</th>
                                    <td class=" top-options">
                                        <div class="col s12 required inline" id="splitConfs">
                                            <div class="radio" id="confref_type">
                                                <label>
                                                    <input class="with-gap" id="refmacradio" name="confproc_type" type="radio" value="refmac">
                                                    <span class="item-label" for="refmacradio">Refmac refine</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="confref_type">
                                                <label>
                                                    <input class="with-gap" id="phenixradio" name="confproc_type" type="radio" value="phenix">
                                                    <span class="item-label" for="phenixradio">Phenix refine</span>
                                                </label>
                                            </div>
                                            <div class="radio" id="confref_type">
                                                <label>
                                            <input class="with-gap" id="manualradio" name="confproc_type" type="radio" value="manual">
                                                <span class="item-label" for="manualradio">Manual refine</span>
                                            </label>
                                            </div>
                                            <div class="radio" id="confref_type">
                                                <label>
                                                <input checked="checked" class="with-gap" id="norefineradio" name="confproc_type" type="radio" value="none">
                                                    <span class="item-label" for="norefineradio">No refine</span>
                                                </label>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Dataset cluster</th>
                                    <td class=" top-options">
                                        <select class="selectbox" disabled id="datasetCluster" name="datasetCluster">
                                        <option disabled selected value="no"> -- select an option -- </option>
                                        <option value="Yes">Yes</option>
                                        <option value="no">No</option>
                                    </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Score models</th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="giantscore">
                                        <option selected value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                    </td>
                                    <tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="bottom-right">
                        <form action="/submit_pandda/" id="sendgiant" method="get" name="sendgiant" size="1" target="_blank">
                            <button class="btn-large maxivorange" name="giantform" onsubmit="return panddasetup()" size="1" type="submit" value="giantinput">Run Giant PanDDA</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card tabcontent" id="Pipedream">
        <div class="card-title">Pipedream Options</div>


        <div class="flexdiv_options  ">
            <div class="flex-left">
                <div>
                    <div class="card-content card-content-left">
                        <div class="card-title">autoPROC options</div>
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>

                                <tr>
                                    <th class=" top-options">Space group</th>
                                    <td class=" top-options">
                                        <input class="selectbox" name="spacegroup" placeholder="P43212"></input>
                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">Cell parameters</th>
                                    <td class=" top-options"><input class="selectbox" name="cellparameters" placeholder="(a, b, c, α, β, γ)"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">StarANISO</th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="staraniso">
                                <option disabled selected value> -- select an option -- </option>
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                            </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Beam centre (X,Y)</th>
                                    <td class=" top-options">
                                        <div style="display:flex"><input class="selectbox" name="xbeampos" placeholder="X: 2574"></input>&nbsp&nbsp<input class="selectbox" name="ybeampos" placeholder="Y: 1895"></input>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Data range</th>
                                    <td class=" top-options"><input class="selectbox" name="datarange" placeholder="e.g.:  1-1800"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Resolution cutoff</th>
                                    <td class=" top-options"><input class="selectbox" name="rescutoff" placeholder="default: None"></input>
                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">Min High-Res limit</th>
                                    <td class=" top-options"><input class="selectbox" name="rmin" placeholder="default: None"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Max Rpim</th>
                                    <td class=" top-options"><input class="selectbox" name="rpim" placeholder="default: None"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Min Completeness</th>
                                    <td class=" top-options"><input class="selectbox" name="completeness" placeholder="default: None"></input>
                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">CC1/2 cutoff</th>
                                    <td class=" top-options"><input class="selectbox" name="cccutoff" placeholder="default: None"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">I/σ(I) cutoff</th>
                                    <td class=" top-options"><input class="selectbox" name="isigmacutoff" placeholder="default: None"></input>
                                    </td>
                                </tr>
                                <tr class="custompar">
                                    <th class=" top-options">Custom parameters</th>
                                    <td class=" top-options"><input class="selectbox" name="customdataproc" placeholder="default: None"></input>
                                    </td>
                                </tr>

                            </tbody>

                        </table>
                    </div>

                </div>
            </div>

            <div class="flex-center">
                <div>

                    <div class="card-content card-content-left">
                        <div class="card-title">BUSTER options</div>
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>
                                <tr>
                                    <th class=" top-options">PDB model</th>
                                    <td class=" top-options">
                                        <select class="refineform selectbox" name="pdbModel">
                                            {% for pdb in pdbs %}
                                                <option value="{{pdb.id}}">{{pdb.filename}}</option>
                                            {% endfor %}
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Chain</th>
                                    <td class=" top-options">
                                        <input class="selectbox" name="pdb_chain" placeholder="ex: A or A,B,D"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">MTZ Reference</th>
                                    <td class=" top-options">
                                        {% comment %} <input id="myHKLFile" type="file"></input> {% endcomment %}
                                        <input accept=".mtz" onchange='onChooseFile(event, onFileLoad.bind(this, "mtzcontent"))' type='file' />

                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">Refinement mode</th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="refMode">
                            <option disabled selected value> -- select an option -- </option>
                            <option value="thorough">Thorough (Slow)</option>
                            <option value="quick">Quick (Fast)</option>
                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Threshold for MR</th>
                                    <td class=" top-options">
                                        <input class="selectbox" name="mrthresh" placeholder="default: 0.4"></input>
                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">Grouping Chains</th>
                                    <td class=" top-options">
                                        <input class="selectbox" name="chains" placeholder="AB C D"></input>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Brute-force TF</th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="btf">
                            <option selected value="false" value>False</option>
                            <option value="true">True</option>
                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">Resolution limits</th>
                                    <td class=" top-options">
                                        <input class="selectbox" name="resolutionlimits" placeholder="[<reslow>] <reshigh>"></input>
                                    </td>
                                </tr>

                                <tr>
                                    <th class=" top-options">Angular range for RF</th>
                                    <td class=" top-options">
                                        <select class="selectbox" name="bigrotrange">
                            <option selected value="false" value>False</option>
                            <option value="true">True</option>
                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <th class=" top-options">PDB_REDO</th>
                                    <td class=" top-options">
                                        <form id="pdbredooptions">
                                            <div class="checkbox" id="dials">
                                                <label>
                                    <input class="filled-in dt-checkboxes" id="remediateckbx" name="remediateckbx" type="checkbox" value="remediate">
                                    <span for="dimplecheckboxinput">SideAide refit</span>
                                </label>
                                            </div>
                                            <div class="checkbox" id="xdsxscale">
                                                <label>
                                    <input class="filled-in dt-checkboxes" id="sidechainbuildckbx" name="sidechainbuildckbx" type="checkbox" value="sidechainbuild">
                                    <span for="bustercheckboxinput">SideAide rebuild </span>
                                </label>
                                            </div>

                                            <div class="checkbox" id="autoproc">
                                                <label>
                                    <input class="filled-in dt-checkboxes" id="runpepflipckbx" name="runpepflipckbx" type="checkbox" value="runpepflip">
                                    <span for="fspcheckboxinput">PepFlip check and correct </span>
                                </label>
                                            </div>
                                        </form>
                                    </td>
                                </tr>
                                <tr class="custompar">
                                    <th class=" top-options">Custom parameters</th>
                                    <td class=" top-options"><input class="selectbox" name="custombuster" placeholder="default: None"></input>
                                    </td>
                                </tr>
                                {% comment %}
                                <tr>
                                    <th></th>
                                    <td style="padding-top:20px">
                                        <input class="btn btn-right" type="button" value="Run refinement"> </input>
                                    </td>
                                </tr> {% endcomment %}
                            </tbody>

                        </table>
                    </div>

                </div>
            </div>


            <div class="flex-right">
                <div>
                    <div class="card-content card-content-right">
                        <div class="card-title">RhoFit options</div>
                        <table class="optionstable">
                            <col width="8%">
                            <col width="17%">
                            <tbody>


                                <tr >
                                    <th class=" top-options">Copies to search</th>
                                    <td class=" top-options"><input class="selectbox" name="numberofcopies" placeholder="default: 1"></input>
                                    </td>
                                    <tr>

                                        <tr>
                                            <th class=" top-options">Keep Hydrogens</th>
                                            <td class=" top-options"><input class="selectbox" name="keepH" placeholder="default: True"></input>
                                            </td>
                                            <tr>
                                                <tr>
                                                    <th class=" top-options">Fit ligand in all sites</th>
                                                    <td class=" top-options"><input class="selectbox" name="allclusters" placeholder="default: False"></input>
                                                    </td>
                                                    <tr>
                                                        <tr>
                                                            <th class=" top-options">Fit ligand to best N sites</th>
                                                            <td class=" top-options"><input class="selectbox" name="xclusters" placeholder="default: 1"></input>
                                                            </td>
                                                            <tr>
                                                                <tr>
                                                                    <th class=" top-options">Post refine to solution</th>
                                                                    <td class=" top-options">
                                                                        <select class="selectbox" name="postrefine">                    
                                                                            <option selected value>No</option>
                                                                            <option value="postquick">Quick</option>
                                                                            <option value="poststandard">Standard</option>
                                                                            <option value="postthorough">Thorough</option>
                                                                        </select>
                                                                    </td>
                                                                    <tr>
                                                                        <tr>
                                                                            <th class=" top-options">Refine ligand occupancy</th>
                                                                            <td class=" top-options">
                                                                                <select class="selectbox" name="nooccref">                    
                                                                                    <option selected value="true" value>True</option>
                                                                                    <option value="false">False</option>

                                                                                </select>
                                                                            </td>
                                                                            <tr>



                                                                            </tr>
                                                                            <tr>
                                                                                <th class=" top-options">Fitting process</th>
                                                                                <td class=" top-options">
                                                                                    <select class="selectbox" name="fitprocess">
                        <option disabled selected value> -- select an option -- </option>
                        <option value="ligfitquick">Quick</option>
                        <option value="ligfitthorough">Thorough</option>
                    </select>
                                    </td>
                                    <tr>
                                    </tr>
                                    <tr>
                                        <th class=" top-options">Scan chirals</th>
                                        <td class=" top-options">
                                            <select class="selectbox" name="scanchirals">
                <option disabled selected value> -- select an option -- </option>
                        <option value="true">Yes</option>
                        <option value="false">No</option>
                    </select>
                                </td>
                            </tr>
                            <tr class="custompar">
                                <th class=" top-options">Custom parameters</th>
                                <td class=" top-options"><input class="selectbox" name="customrhofit" placeholder="default: None"></input>
                                </td>
                            </tr>
                            {% comment %}
                            <tr>
                                <th></th>
                                <td style="padding-top:20px">

                                    <input class="btn btn-right" type="button" value="Run ligand fitting"> </input>
                                </td>
                            </tr> {% endcomment %}

                            </tbody>
                        </table>
                    </div>
                </div>

            </div>



        </div>
            <div style="padding-left: 45%;">
                <form action="/submit_pipedream/" id="sendpipedreamBtn" method="get" name="sendpipedreamBtn" size="1">
                    <button class="btn-large maxivorange" name="ppdform" onsubmit="return submit_pipedream()" size="1" type="submit" value="pipedreamInput">Run Pipedream</button>
                </form>
            </div>
    </div>

</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>


<script src="https://welcome.totheinter.net/autocolumn/autocolumn.js"></script>



<script>
    function openMethod(evt, methodName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(methodName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    function openDatasets(evt, DatasetsName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(DatasetsName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>

<script>
    $(document).ready(function() {
        $("#processALLckbox").click(function() {
            if ($(this).is(":checked")) {
                $("#dropdownDataset").prop("disabled", true);
                $("#processALLNEWckbox").prop("checked", false);
                openDatasets(event, 'HideDatasets')
            } else {
                $("#dropdownDataset").prop("disabled", false);
                openDatasets(event, 'Datasets')
            }
        });
    });
    $(document).ready(function() {
        $("#processALLNEWckbox").click(function() {
            if ($(this).is(":checked")) {
                $("#processALLckbox").prop("checked", false);
            } 
        });
    });

    $(document).ready(function() {
        $("#panddacheckboxinput").click(function() {
            if ($(this).is(":checked")) {
                openDatasets(event, 'PanDDA')
            } else {
                openDatasets(event, 'Hide')
            }
        });
    });
    $(document).ready(function() {
        $("#checkALLdatasets").click(function() {
            if ($(this).is(":checked")) {
                checkAll()
            } else {
                checkNone()

            }
        });
    });

    function getDtsFilters() {
        if (document.getElementById("processALLckbox").checked) {
            return "ALL";
        }

        if (document.getElementById("processALLNEWckbox").checked) {
            return "NEW";
        }

        return getCheckedBoxes("checkSel");
    }

    function getHpcNodes() {
        return document.querySelector('input[name="node_number"]:checked').value;
    }

    function getCIFmethod() {
        return document.querySelector('input[name="library_method"]:checked').value;
    }

    var f = document.getElementById("dtprocBtn");

    f.onsubmit = function dataproc() {

        /* Data proc options */
        var friedel = document.getElementsByName("friedel")[0].value
        var datarange = ";;datarange:" + document.getElementsByName("datarange")[0].value
        var rescutoff = ";;rescutoff:" + document.getElementsByName("rescutoff")[0].value
        var cccutoff = ";;cccutoff:" + document.getElementsByName("cccutoff")[0].value
        var isigicutoff = ";;isigicutoff:" + document.getElementsByName("isigmacutoff")[0].value
        var customxds = document.getElementsByName("customdataproc-xds")[0].value
        var customxdsapp = document.getElementsByName("customdataproc-xdsapp")[0].value
        var customdials = document.getElementsByName("customdataproc-dials")[0].value
        var customautoproc = document.getElementsByName("customdataproc-autoproc")[0].value

        $("#friedelLawProc").val(friedel);
        $("#hpcNodesProc").val(getHpcNodes());
        $("#dtsFilterProc").val(getDtsFilters());

        $("#customXds").val(customxds);
        $("#customAutoProc").val(customautoproc);
        $("#customDials").val(customdials);
        $("#customXdsApp").val(customxdsapp);
    }

    var f2 = document.getElementById("rfprocBtn");

    f2.onsubmit = function refineproc() {
        //Refinement options
        var refinemode = ";;refinemode:" + document.getElementsByName("refMode")[0].value
        var mrthreshold = ";;mrthreshold:" + document.getElementsByName("mrthresh")[0].value
        var refinerescutoff = ";;refinerescutoff:" + document.getElementsByName("refrescutoff")[0].value

        var customrefdimple = "customrefinedimple:" + document.getElementsByName("customrefine-dimple")[0].value
        var customrefbuster = "customrefinebuster:" + document.getElementsByName("customrefine-buster")[0].value
        var customreffspipe = "customrefinefspipe:" + document.getElementsByName("customrefine-fsp")[0].value

        document.getElementsByName("customRefDimple")[0].value = customrefdimple;
        document.getElementsByName("customRefBuster")[0].value = customrefbuster;
        document.getElementsByName("customRefFspipe")[0].value = customreffspipe;

        $("#hpcNodesRefine").val(getHpcNodes());
        $("#dtsFilterRefine").val(getDtsFilters());
    }

    var f3 = document.getElementById("ligprocBtn");

    f3.onsubmit = function ligandfitproc() {
        /* Ligand fit options */
        $("#hpcNodesLigfit").val(getHpcNodes());
        $("#cifMethodLigfit").val(getCIFmethod());
        $("#dtsFilterLigfit").val(getDtsFilters());
    }

    // { % comment % }
    // var fAll = document.getElementById("allprocBtn");

    // fAll.onsubmit = function dataprocess() {
    //     //Data proc options
    //     var dialsSW = ";;dials:" + document.getElementsByName("dialscheckboxname")[0].checked
    //     var xdsxscaleSW = ";;xdsxscale:" + document.getElementsByName("xdsxscalecheckboxname")[0].checked
    //     var xdsappSW = ";;xdsapp:" + document.getElementsByName("xdsappcheckboxname")[0].checked
    //     var autoprocSW = ";;autoproc:" + document.getElementsByName("autoproccheckboxname")[0].checked
    //     var spacegroup = ";;spacegroup:" + document.getElementsByName("spacegroup")[0].value
    //     var cellparam = ";;cellparam:" + document.getElementsByName("cellparam")[0].value
    //     var friedel = ";;friedel:" + document.getElementsByName("friedel")[0].value
    //     var datarange = ";;datarange:" + document.getElementsByName("datarange")[0].value
    //     var rescutoff = ";;rescutoff:" + document.getElementsByName("rescutoff")[0].value
    //     var cccutoff = ";;cccutoff:" + document.getElementsByName("cccutoff")[0].value
    //     var isigicutoff = ";;isigicutoff:" + document.getElementsByName("isigmacutoff")[0].value

    //     //Refinement options
    //     var dimpleSW = ";;dimpleSW:" + document.getElementsByName("dimplecheckboxname")[0].checked
    //     var fspSW = ";;fspSW:" + document.getElementsByName("fspcheckboxname")[0].checked
    //     var busterSW = ";;busterSW:" + document.getElementsByName("bustercheckboxname")[0].checked
    //     var refinemode = ";;refinemode:" + document.getElementsByName("refMode")[0].value
    //     var mrthreshold = ";;mrthreshold:" + document.getElementsByName("mrthresh")[0].value
    //     var refinerescutoff = ";;refinerescutoff:" + document.getElementsByName("refrescutoff")[0].value
    //     if (document.getElementById("pdbcontent").innerHTML.includes("ATOM")) {
    //         var pdbmodel = ";;pdbupload:" + document.getElementById("pdbcontent").innerHTML
    //     } else {
    //         var pdbmodel = ";;pdbmodel:" + document.getElementsByName("pdbcode")[0].value
    //     }
    //     var customrefparam = ";;customrefine:" + document.getElementsByName("customrefine")[0].value

    //     //Ligand fit options
    //     var rhofitSW = ";;rhofitSW:" + document.getElementsByName("rhofitcheckboxname")[0].checked
    //     var ligfitSW = ";;ligfitSW:" + document.getElementsByName("phenixligfitcheckboxname")[0].checked
    //     var ligandfile = ";;ligandfile:" + document.getElementById("ligcontent").innerHTML
    //     var fitprocess = ";;fitprocess:" + document.getElementsByName("fitprocess")[0].value
    //     var scanchirals = ";;scanchirals:" + document.getElementsByName("scanchirals")[0].value
    //     var customligfit = ";;customligfit:" + document.getElementsByName("customligfit")[0].value

    //     var dtproccmd = dialsSW + xdsxscaleSW + xdsappSW + autoprocSW + spacegroup + cellparam + friedel +
    //         datarange + rescutoff + cccutoff + isigicutoff
    //     var refinecmd = dimpleSW + fspSW + busterSW + refinemode + mrthreshold + refinerescutoff + pdbmodel
    //     var ligfitcmd = rhofitSW + ligfitSW + ligandfile + fitprocess + scanchirals + customligfit
    //     if (document.getElementById("processALLckbox").checked) {
    //         var dtsfilters = ";;filters: "
    //     } else {
    //         var dtsfilters = ";;filters:" + document.getElementsByName("dropdownDataset")[0].value
    //     }

    //     document.getElementsByName("submitallProc")[0].value = dtproccmd + refinecmd + ligfitcmd + dtsfilters

    // }

    // function onFileLoad(elementId, event) {
    //     document.getElementById(elementId).innerText = event.target.result;
    // }

    // function onChooseFile(event, onLoadFileHandler) {
    //     if (typeof window.FileReader !== 'function')
    //         throw ("The file API isn't supported on this browser.");
    //     let input = event.target;
    //     if (!input)
    //         throw ("The browser does not properly implement the event object");
    //     if (!input.files)
    //         throw ("This browser does not support the `files` property of the file input.");
    //     if (!input.files[0])
    //         return undefined;
    //     let file = input.files[0];
    //     let fr = new FileReader();
    //     fr.onload = onLoadFileHandler;
    //     fr.readAsText(file);
    // } { % endcomment % }


    var sliderj = document.getElementById("jellyRange");
    var outputj = document.getElementById("jellyvalue");
    outputj.innerHTML = sliderj.value;

    sliderj.oninput = function() {
        outputj.innerHTML = this.value;
    }


    var sliderr = document.getElementById("rigidRange");
    var outputr = document.getElementById("rigidvalue");
    outputr.innerHTML = sliderr.value;

    sliderr.oninput = function() {
        outputr.innerHTML = this.value;
    }

    document.getElementById("fspcDiffvalue").innerHTML = document.getElementById("fspcd").value;
    document.getElementById("fspcd").oninput = function() {
        document.getElementById("fspcDiffvalue").innerHTML = this.value;
    }
    document.getElementById("fspcBlobvalue").innerHTML = document.getElementById("fspcb").value / 10;
    document.getElementById("fspcb").oninput = function() {
        document.getElementById("fspcBlobvalue").innerHTML = this.value / 10;
    }



    $(".refineform").on("input", function(e) {
        if (document.getElementById("fspcheckboxinput").checked +
            document.getElementById("bustercheckboxinput").checked +
            document.getElementById("dimplecheckboxinput").checked != 0) {
            document.getElementById("submitrfProc").disabled = false;
        } else {
            document.getElementById("submitrfProc").disabled = true;
        }
    });

    $('.processform').on('input', function(e) {
        if (document.getElementById("dialscheckboxinput").checked +
            document.getElementById("xdsxscalecheckboxinput").checked +
            document.getElementById("xdsappcheckboxinput").checked +
            document.getElementById("autoproccheckboxinput").checked != 0) {
            document.getElementById("submitdtProc").disabled = false;
        } else {
            document.getElementById("submitdtProc").disabled = true;
        }
    });

    $('.ligandform').on('input', function(e) {
        if (document.getElementById("rhofitcheckboxinput").checked +
            document.getElementById("phenixligfitcheckboxinput").checked != 0) {
            document.getElementById("submitligProc").disabled = false;
        } else {
            document.getElementById("submitligProc").disabled = true;
        }
    });

    $(function() {

        $(".pipedreamcheck").change(function() {

            var x = this.checked;
            $(".pipedreamcheck").prop("checked", x);

            $(".pipedreamcheck").on("load", openMethod(event, 'Pipedream'))
        });
    });


    function toggle(source) {
        checkboxes = document.getElementsByName('checkSel');
        for (var i = 0, n = checkboxes.length; i < n; i++) {
            checkboxes[i].checked = source.checked;
        }
    }

    function getCheckedBoxes(chkboxName) {
        var checkboxes = document.getElementsByName(chkboxName);
        var checkboxesChecked = [];
        // loop over them all
        for (var i = 0; i < checkboxes.length; i++) {
            // And stick the checked ones onto an array...
            if (checkboxes[i].checked) {
                checkboxesChecked.push(checkboxes[i].id.slice(14));
            }
        }
        // Return the array if it is non-empty, or null
        return checkboxesChecked.length > 0 ? checkboxesChecked : null;
    }
    function checkAll() {
       var chckboxes = document.getElementsByName("checkSel");
       for (var i = 0; i < chckboxes.length; i++) {
          chckboxes[i].checked = true;
       }
    }
    function checkNone() {
       var chckboxes = document.getElementsByName("checkSel");
       for (var i = 0; i < chckboxes.length; i++) {
          chckboxes[i].checked = false;
       }
    }
</script>


<script>
    // PanDDA parser
    var f5 = document.getElementById("sendpandda");

    f5.onsubmit = function panddasetup() {

        var proc_type = document.querySelector('input[name="proc_type"]:checked').value;
        var ref_type = document.querySelector('input[name="ref_type"]:checked').value;

        var complete = document.getElementsByName("compdatasets")[0].value;

        var use_apo = document.getElementById("apoGS").checked
        var use_dmso = document.getElementById("dmsoGS").checked
        var proczMaps = document.getElementById("proczMaps").checked

        var use_CAD = document.getElementById("use_CAD").value
        var ref_CAD = document.getElementById("refine_popMTZ").value

        var ign_errordts = document.getElementById("ignoreErr").checked
        var keepup_last = document.getElementById("keepup").checked
        var ign_symlink = document.getElementById("fixsym").checked
        var min_datasets = document.getElementById("min_datasets").value
        var PanDDAcustom = document.getElementById("PanDDAcustom").value
        var pandda_max_rfree = "max_rfree="+document.getElementById("pandda_max_rfree").value
        var pandda_high_res_upper_limit = "high_res_upper_limit="+document.getElementById("pandda_res_high_limit").value
        var pandda_high_res_lowe_limit = "high_res_lower_limit="+document.getElementById("pandda_res_low_limit").value
        var PanDDAfilter = "" + getCheckedBoxes("checkSel");
        var cifMethodPandda = document.querySelector('input[name="library_method"]:checked').value;
        var PanDDAout = "analyse;" + proc_type + ";" + ref_type + ";" + complete + ";" +
            use_apo + ";" + use_dmso + ";" + proczMaps + ";" + use_CAD + ";" + ref_CAD + ";" +
            ign_errordts + ";" + keepup_last + ";" + ign_symlink + ";" + PanDDAfilter  + ";" + min_datasets + ";" +
            PanDDAcustom + " " + pandda_max_rfree + " " + pandda_high_res_upper_limit + " " +
            pandda_high_res_lowe_limit + ";" + cifMethodPandda

        document.getElementsByName("panddaform")[0].value = PanDDAout

    }

    var f6 = document.getElementById("sendgiant");

    f6.onsubmit = function giantsetup() {

        var method = document.getElementById("inspects").value;


        var out = "giantscore;" + method
        document.getElementsByName("giantform")[0].value = out

    }
</script>

<script>
    var fpipedream = document.getElementById("sendpipedreamBtn");

    fpipedream.onsubmit = function submit_pipedream(){

    var datasetSelect=document.getElementsByName("dropdownDataset")[0].value
    if (datasetSelect != "alldatasets"){
        var outdir=datasetSelect.replace("/raw/","/fragmax/process/pipedream/")
        outdir = outdir.replace("_master.h5","")
    }

    //autoPROC parameters
    var ap_spacegroup       = document.getElementsByName("spacegroup")[0].value;
    var ap_cellparam        = document.getElementsByName("cellparameters")[0].value;
    var ap_staraniso        = document.getElementsByName("staraniso")[0].value;
    var ap_xbeamcent        = document.getElementsByName("xbeampos")[0].value;
    var ap_ybeamcent        = document.getElementsByName("ybeampos")[0].value;
    var ap_datarange        = document.getElementsByName("datarange")[0].value;
    var ap_rescutoff        = document.getElementsByName("rescutoff")[0].value;
    var ap_highreslim       = document.getElementsByName("rmin")[0].value;
    var ap_maxrpim          = document.getElementsByName("rpim")[0].value;
    var ap_mincomplet       = document.getElementsByName("completeness")[0].value;
    var ap_cchalfcut        = document.getElementsByName("cccutoff")[0].value;
    var ap_isigicut         = document.getElementsByName("isigmacutoff")[0].value;
    var ap_custompar        = document.getElementsByName("customdataproc")[0].value;


    //BUSTER parameters
    var b_userPDBfile       = document.getElementById("pdbcontent").innerHTML
    var b_userPDBcode       = document.getElementsByName("PDBID_code")[0].value;
    var b_userMTZfile       = document.getElementById("mtzcontent").innerHTML;
    var b_refinemode        = document.getElementsByName("refMode")[0].value;
    var b_MRthreshold       = document.getElementsByName("mrthresh")[0].value;
    var b_chainsgroup       = document.getElementsByName("chains")[0].value;
    var b_bruteforcetf      = document.getElementsByName("btf")[0].value;
    var b_reslimits         = document.getElementsByName("resolutionlimits")[0].value;
    var b_angularrf         = document.getElementsByName("bigrotrange")[0].value;
    var b_sideaiderefit     = document.getElementsByName("remediateckbx")[0].checked;
    var b_sideaiderebuild   = document.getElementsByName("sidechainbuildckbx")[0].checked;
    var b_pepflip           = document.getElementsByName("runpepflipckbx")[0].checked;
    var b_custompar         = document.getElementsByName("custombuster")[0].value;

    //RhoFit parameters

    var rho_ligandsmiles    = document.getElementsByName("ligsmiles")[0].value;
    var rho_ligandcode      = document.getElementsByName("ligscreencode")[0].value;
    var rho_ligandfromname  = document.getElementsByName("ligfromname")[0].checked;
    var rho_copiestosearch  = document.getElementsByName("numberofcopies")[0].value;
    var rho_keepH           = document.getElementsByName("keepH")[0].value;
    var rho_allclusters     = document.getElementsByName("allclusters")[0].value;
    var rho_xclusters       = document.getElementsByName("xclusters")[0].value;
    var rho_postrefine      = document.getElementsByName("postrefine")[0].value;
    var rho_occuprefine     = document.getElementsByName("nooccref")[0].value;
    var rho_fittingproc     = document.getElementsByName("fitprocess")[0].value;
    var rho_scanchirals     = document.getElementsByName("scanchirals")[0].value;
    var rho_custompar       = document.getElementsByName("customrhofit")[0].value;


    //processed
    var rho_ligand ="still not here" //define the ligand from one of the options
    var pdbinp="3ks3" //get path or file content from user
    var beamcentre = '"'+ap_xbeamcent+' '+ap_ybeamcent+'"'


    //pipedream command line generator
    var pipedream_cmd= ""

    pipedream_cmd+=";;input_data:"+datasetSelect
    pipedream_cmd+=";;ap_spacegroup:"+ap_spacegroup
    pipedream_cmd+=";;ap_cellparam:"+ap_cellparam
    pipedream_cmd+=";;ap_staraniso:"+ap_staraniso
    pipedream_cmd+=";;ap_xbeamcent:"+ap_xbeamcent
    pipedream_cmd+=";;ap_ybeamcent:"+ap_ybeamcent
    pipedream_cmd+=";;ap_datarange:"+ap_datarange
    pipedream_cmd+=";;ap_rescutoff:"+ap_rescutoff
    pipedream_cmd+=";;ap_highreslim:"+ap_highreslim
    pipedream_cmd+=";;ap_maxrpim:"+ap_maxrpim
    pipedream_cmd+=";;ap_mincomplet:"+ap_mincomplet
    pipedream_cmd+=";;ap_cchalfcut:"+ap_cchalfcut
    pipedream_cmd+=";;ap_isigicut:"+ap_isigicut
    pipedream_cmd+=";;ap_custompar:"+ap_custompar
    pipedream_cmd+=";;b_userPDBfile:"+"b_userPDBfile"
    pipedream_cmd+=";;b_userPDBcode:"+b_userPDBcode
    pipedream_cmd+=";;b_userMTZfile:"+"b_userMTZfile"
    pipedream_cmd+=";;b_refinemode:"+b_refinemode
    pipedream_cmd+=";;b_MRthreshold:"+b_MRthreshold
    pipedream_cmd+=";;b_chainsgroup:"+b_chainsgroup
    pipedream_cmd+=";;b_bruteforcetf:"+b_bruteforcetf
    pipedream_cmd+=";;b_reslimits:"+b_reslimits
    pipedream_cmd+=";;b_angularrf:"+b_angularrf
    pipedream_cmd+=";;b_sideaiderefit:"+b_sideaiderefit
    pipedream_cmd+=";;b_sideaiderebuild:"+b_sideaiderebuild
    pipedream_cmd+=";;b_pepflip:"+b_pepflip
    pipedream_cmd+=";;b_custompar:"+b_custompar
    pipedream_cmd+=";;rho_ligandsmiles:"+rho_ligandsmiles
    pipedream_cmd+=";;rho_ligandcode:"+rho_ligandcode
    pipedream_cmd+=";;rho_ligandfromname:"+rho_ligandfromname
    pipedream_cmd+=";;rho_copiestosearch:"+rho_copiestosearch
    pipedream_cmd+=";;rho_keepH:"+rho_keepH
    pipedream_cmd+=";;rho_allclusters:"+rho_allclusters
    pipedream_cmd+=";;rho_xclusters:"+rho_xclusters
    pipedream_cmd+=";;rho_postrefine:"+rho_postrefine
    pipedream_cmd+=";;rho_occuprefine:"+rho_occuprefine
    pipedream_cmd+=";;rho_fittingproc:"+rho_fittingproc
    pipedream_cmd+=";;rho_scanchirals:"+rho_scanchirals
    pipedream_cmd+=";;rho_custompar:"+rho_custompar
    pipedream_cmd+=';;extras:-nthreads -1  -v '


    document.getElementsByName("ppdform")[0].value = pipedream_cmd

}

</script>
{% endblock %}